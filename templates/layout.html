<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{{ title or "CareWhistle" }}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme:{
        extend:{
          colors:{
            base: { bg:"#ffffff", card:"#f8fafc", ink:"#1e293b", muted:"#64748b" },
            brand: {
              blue:"#1e40af",
              indigo:"#3b82f6",
              cyan:"#0ea5e9",
              pink:"#f472b6",
              amber:"#fbbf24",
              slate:"#94a3b8"
            }
          },
          boxShadow:{
            glass:"0 10px 30px rgba(31,41,55,.08), inset 0 1px 0 rgba(255,255,255,.5)"
          }
        }
      }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <link rel="icon" href="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20viewBox%3D%270%200%2024%2024%27%3E%3Cpath%20fill%3D%27%23111827%27%20d%3D%27M8.5%209A6.5%206.5%200%200%200%202%2015.5A6.5%206.5%200%200%200%208.5%2022A6.5%206.5%200%200%200%2015%2015.5V13.91L22%2012V9H11V11H9V9H8.5M11%202V7H9V2H11M6.35%207.28c-.67.16-1.31.4-1.92.72L2.14%204.88%203.76%203.7%206.35%207.28M17.86%204.88%2016.32%207h-2.47L16.24%203.7l1.62%201.18Z%27/%3E%3C/svg%3E">
</head>
<body class="bg-base-bg text-base-ink">
  <header class="sticky top-0 z-40 backdrop-blur bg-white/80 border-b">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-4">
      <a href="{{ url_for('home') }}" class="flex items-center gap-2 font-extrabold text-lg">
        <span class="inline-flex items-center justify-center w-10 h-10 rounded-lg bg-gradient-to-br from-brand-blue to-brand-indigo text-white shadow-glass ring-2 ring-white">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor">
            <path d="M8.5 9A6.5 6.5 0 0 0 2 15.5 6.5 6.5 0 0 0 8.5 22 6.5 6.5 0 0 0 15 15.5V13.91L22 12V9H11V11H9V9H8.5M11 2V7H9V2H11M6.35 7.28c-.67.16-1.31.4-1.92.72L2.14 4.88 3.76 3.7 6.35 7.28M17.86 4.88 16.32 7h-2.47L16.24 3.7l1.62 1.18Z"/>
          </svg>
        </span>
        <span class="bg-gradient-to-r from-brand-blue to-brand-indigo bg-clip-text text-transparent">CareWhistle</span>
      </a>
      <nav class="ml-6 flex items-center gap-4 text-sm">
        <a class="transition-colors hover:text-brand-blue" href="{{ url_for('home') }}">Home</a>
        <a class="transition-colors hover:text-brand-blue" href="{{ url_for('how') }}">How it works</a>
        <a class="transition-colors hover:text-brand-blue" href="{{ url_for('report') }}">Make a Report</a>
        <a class="transition-colors hover:text-brand-blue" href="{{ url_for('pricing') }}">Plans & Pricing</a>
      </nav>
      <div class="ml-auto flex items-center gap-2">
        <a class="px-3 py-1.5 rounded-lg border border-brand-blue text-brand-blue hover:bg-brand-blue hover:text-white transition-colors" href="{{ url_for('follow') }}">Case Portal</a>
        {% if session.get('user_id') %}
          {% if session.get('role')=='admin' %}
            <a class="px-3 py-1.5 rounded-lg bg-brand-blue text-white" href="{{ url_for('admin_dashboard') }}">Admin</a>
          {% elif session.get('role')=='manager' %}
            <a class="px-3 py-1.5 rounded-lg bg-brand-indigo text-white" href="{{ url_for('manager_overview') }}">Manager</a>
          {% endif %}
          <a class="px-3 py-1.5 rounded-lg bg-brand-indigo text-white" href="{{ url_for('logout') }}">Logout</a>
        {% else %}
          <a class="px-3 py-1.5 rounded-lg bg-brand-blue text-white" href="{{ url_for('login') }}">Login</a>
        {% endif %}
      </div>
    </div>
  </header>

  {% with msgs = get_flashed_messages(with_categories=True) %}
    {% if msgs %}
    <div class="max-w-4xl mx-auto mt-4 px-4">
      {% for c,m in msgs %}
        <div class="mb-2 px-4 py-2 rounded-lg border bg-white shadow">{{ m }}</div>
      {% endfor %}
    </div>
    {% endif %}
  {% endwith %}

  {% block body %}{% endblock %}

  <footer class="mt-16 py-8 text-center text-sm text-base-muted">
    © {{ current_year }} CareWhistle — Independent whistleblowing service. <span class="mx-2">•</span> help@carewhistle.app
  </footer>

  {% include 'chatbot.html' %}
</body>
</html>
